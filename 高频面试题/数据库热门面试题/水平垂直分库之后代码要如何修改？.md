# 水平/垂直分库之后代码要如何修改

> 本文作者：[程序员牛肉](https://github.com/luoye6)
>
> 本站地址：[https://xbt.xiaobaitiao.top](https://xbt.xiaobaitiao.top)

- 数据库连接方式：原本是一个数据库实例，分库之后要连接多个数据库实例，设置主库和从库，设置匹配模式，可以引入MP的dynamic动态数据源，用注解@DS在业务层（service)注明使用的数据源。
- SQL语句修改：在分库之后，SQL语句的表名和查询条件都需要进行修改。
- 事务管理: 分库分片后库与库之间的数据依赖关系，事务管理变得更为复杂，需要事务的处理逻辑进行重构。
- ORM框架：像使用mybatis,jpa,hibernate，需要对配置文件进行修改。
- 数据迁移: 分库分片之前，需要对数据进行迁移，按照规则分配到不同的数据库。