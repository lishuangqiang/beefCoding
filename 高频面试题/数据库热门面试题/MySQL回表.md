# MySQL回表

> 本文作者：[程序员牛肉](https://github.com/luoye6)
>
> 本站地址：[https://xbt.xiaobaitiao.top](https://xbt.xiaobaitiao.top)

- 是什么？MySQL回表指的是在进行索引查询时，需要在主键索引中回溯查找其它列的值的操作，也就是需要再到主键索引的叶子节点中查找该行所对应的记录，并返回记录的所有列。回表一般发生在覆盖索引无法满足查询需求的情况下，例如查询需要的列不在索引列中，或者使用了函数或表达式而无法使用索引覆盖等情况。
- 回表的影响： 回表的实现需要进行一次根据主键索引的查找，然后再到对应的数据页中读取全部记录，对于大量的数据处理场景，回表操作带来的额外IO负担和延迟影响都是不可忽视的，因此需要避免在高并发、大数据量的场景中进行回表操作。
- 避免回表操作的一些方法: 1.覆盖索引，将查询的列尽量都加入到索引中，从而避免回表操作。2.查询重构，改写SQL语句来避免回表发生，例如使用联合查询union,避免使用不必要的函数和表达式。

**MySQL的回表操作通常在以下情况下会发生：**

2.1 索引不Cover所有需要查询的字段

当查询语句中需要返回的列不在索引列上时，即使通过索引定位了相关行，仍然需要回表获取其他列的值。

2.2 使用了非聚簇索引

非聚簇索引（Secondary Index）只包含了索引列的副本以及指向对应主键的引用，查询需要通过回表才能获取完整的行数据。

2.3 使用了覆盖索引但超过了最大索引长度

在MySQL的InnoDB存储引擎中，每个索引项的最大长度是767字节，如果查询需要返回的字段长度超过了该限制，同样会触发回表操作。

需要注意的是，回表操作主要发生在读取操作（SELECT）中，写入操作（INSERT、UPDATE、DELETE）一般不会触发回表。